<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Media API Service</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container-fluid">
        <!-- Header Section -->
        <div class="header">
            <div class="container">
                <i class="fab fa-youtube logo"></i>
                <h1 class="display-4 fw-bold">YouTube Media API</h1>
                <p class="lead">Professional YouTube audio/video extraction with Telegram storage</p>
                <span class="badge-api">API v{{ api_version }}</span>
            </div>
        </div>

        <div class="container">
            <!-- Demo Section -->
            <div class="demo-section">
                <h2><i class="fas fa-play-circle"></i> Try the API</h2>
                <p class="text-muted">Test the API directly from your browser</p>
                
                <div class="row">
                    <div class="col-md-8">
                        <div class="mb-3">
                            <label for="apiKey" class="form-label">API Key</label>
                            <input type="text" class="form-control" id="apiKey" placeholder="Enter your API key">
                        </div>
                        <div class="mb-3">
                            <label for="query" class="form-label">Search Query</label>
                            <input type="text" class="form-control" id="query" placeholder="e.g., Maiyya Mainu Sachet Tandon">
                        </div>
                        <div class="mb-3">
                            <label for="format" class="form-label">Format</label>
                            <select class="form-select" id="format">
                                <option value="audio">Audio (MP3)</option>
                                <option value="video">Video (MP4)</option>
                            </select>
                        </div>
                        <button class="btn btn-primary btn-lg" onclick="testAPI()">
                            <i class="fas fa-download"></i> Extract Media
                        </button>
                    </div>
                    <div class="col-md-4">
                        <div class="result-panel">
                            <h5>Result</h5>
                            <div id="result">
                                <p class="text-muted">Enter query and click Extract Media to see results</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- API Documentation -->
            <div class="row">
                <div class="col-md-8">
                    <h2><i class="fas fa-code"></i> API Endpoints</h2>
                    
                    <!-- Extract Media Endpoint -->
                    <div class="endpoint">
                        <div class="d-flex align-items-center mb-3">
                            <span class="method get">GET</span>
                            <code>/api/v1/extract</code>
                        </div>
                        <h5>Extract YouTube Media</h5>
                        <p>Extract audio or video from YouTube with intelligent caching.</p>
                        
                        <h6>Parameters:</h6>
                        <ul>
                            <li><strong>query</strong> (required): Search query or YouTube URL</li>
                            <li><strong>format</strong> (optional): "audio" or "video" (default: audio)</li>
                            <li><strong>force_download</strong> (optional): Force new download ignoring cache</li>
                            <li><strong>api_key</strong> (required): Your API key</li>
                        </ul>
                        
                        <div class="example">
                            <h6>Example Request:</h6>
                            <pre><code>GET /api/v1/extract?query=Maiyya%20Mainu&format=audio&api_key=YOUR_API_KEY</code></pre>
                        </div>
                        
                        <div class="example">
                            <h6>Example Response:</h6>
                            <pre><code>{
  "status": "success",
  "cached": false,
  "data": {
    "title": "Maiyya Mainu â€“ Sachet Tandon",
    "youtube_id": "abc123",
    "duration": "3:20",
    "file_id": "BAADBAADqwADBRAABYldFQABrQIABAg",
    "file_type": "audio",
    "processing_time": 12.5
  }
}</code></pre>
                        </div>
                    </div>

                    <!-- Search Cache Endpoint -->
                    <div class="endpoint">
                        <div class="d-flex align-items-center mb-3">
                            <span class="method get">GET</span>
                            <code>/api/v1/search</code>
                        </div>
                        <h5>Search Cached Media</h5>
                        <p>Search for previously extracted media in cache.</p>
                        
                        <h6>Parameters:</h6>
                        <ul>
                            <li><strong>query</strong> (required): Search query</li>
                            <li><strong>api_key</strong> (required): Your API key</li>
                        </ul>
                    </div>

                    <!-- Health Check Endpoint -->
                    <div class="endpoint">
                        <div class="d-flex align-items-center mb-3">
                            <span class="method get">GET</span>
                            <code>/api/v1/health</code>
                        </div>
                        <h5>Health Check</h5>
                        <p>Check API service health and version.</p>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="features-card">
                        <h3><i class="fas fa-star"></i> Features</h3>
                        <ul class="features-list">
                            <li><i class="fas fa-rocket"></i> Lightning fast with smart caching</li>
                            <li><i class="fas fa-cloud"></i> Telegram permanent storage</li>
                            <li><i class="fas fa-search"></i> Intelligent query matching</li>
                            <li><i class="fas fa-music"></i> High-quality audio extraction</li>
                            <li><i class="fas fa-video"></i> HD video download support</li>
                            <li><i class="fas fa-shield-alt"></i> Rate limiting protection</li>
                            <li><i class="fas fa-key"></i> API key authentication</li>
                            <li><i class="fas fa-chart-line"></i> Usage analytics</li>
                            <li><i class="fas fa-sync"></i> Auto-retry mechanisms</li>
                            <li><i class="fas fa-mobile-alt"></i> Mobile-friendly responses</li>
                        </ul>
                    </div>

                    <div class="features-card mt-4">
                        <h3><i class="fas fa-cog"></i> Configuration</h3>
                        <ul class="features-list">
                            <li><i class="fas fa-server"></i> Multiple extraction sources</li>
                            <li><i class="fas fa-database"></i> PostgreSQL/SQLite support</li>
                            <li><i class="fas fa-robot"></i> Telegram bot integration</li>
                            <li><i class="fas fa-tachometer-alt"></i> Configurable rate limits</li>
                            <li><i class="fas fa-users"></i> Multi-user API keys</li>
                            <li><i class="fas fa-clock"></i> TTL cache management</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Authentication Section -->
            <div class="row mt-5">
                <div class="col-12">
                    <div class="endpoint">
                        <h2><i class="fas fa-lock"></i> Authentication</h2>
                        <p>All API requests require authentication using an API key. Include your API key in one of these ways:</p>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <h5>Query Parameter</h5>
                                <pre><code>GET /api/v1/extract?api_key=YOUR_API_KEY&query=...</code></pre>
                            </div>
                            <div class="col-md-6">
                                <h5>HTTP Header</h5>
                                <pre><code>X-API-Key: YOUR_API_KEY</code></pre>
                            </div>
                        </div>
                        
                        <div class="alert alert-info mt-3">
                            <i class="fas fa-info-circle"></i>
                            <strong>Need an API key?</strong> Contact the administrator to get your API key with custom rate limits.
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <footer class="text-center mt-5 pt-4 border-top">
                <p class="text-muted">
                    <i class="fas fa-code"></i> 
                    Powered by Flask, yt-dlp, and Telegram Bot API
                </p>
                <p class="text-muted">
                    <a href="/admin" class="text-decoration-none">
                        <i class="fas fa-tools"></i> Admin Panel
                    </a>
                </p>
            </footer>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
